<script>
  AFRAME.registerComponent('collectible', {
      init() {
          this.el.addEventListener('click', () => {
              this.collect();
          });
      },
      collect() {
          // Увеличиваем счет
          let scoreElement = document.querySelector('#scoreboard');
          let score = parseInt(scoreElement.getAttribute('text').value.split(': ')[1]) || 0;
          score++;
          scoreElement.setAttribute('text', 'value', `Score: ${score}`);

          // Перемещаем объект на новую случайную позицию
          const newX = (Math.random() - 0.5) * 20; // Случайное значение X от -10 до 10
          const newZ = (Math.random() - 0.5) * 20; // Случайное значение Z от -10 до 10
          this.el.setAttribute('position', { x: newX, y: 0.5, z: newZ });
      }
  });

  let timeLeft = 60;
  let timerElement = document.querySelector('#timer');

  function updateTimer() {
      if (timeLeft > 0) {
          timeLeft--;
          timerElement.setAttribute('text', 'value', `Time: ${timeLeft}`);
      } else {
          endGame();
      }
  }

  setInterval(updateTimer, 1000);

  function endGame() {
      let finalScore = parseInt(document.querySelector('#scoreboard').getAttribute('text').value.split(': ')[1]);
      alert(`Game over! Your final score is: ${finalScore}`);

      // Показываем текст "Game Over" и финальный счет
      document.querySelector('#gameOverText').setAttribute('visible', true);
      document.querySelector('#finalScoreText').setAttribute('text', 'value', `Score: ${finalScore}`);
      document.querySelector('#finalScoreText').setAttribute('visible', true);

      // Добавляем возможность рестарта
      document.querySelector('#restartButton').addEventListener('click', () => {
          location.reload();
      });
  }

  // Инициализация collectible объектов
  document.querySelectorAll('.collectible').forEach(el => {
      el.setAttribute('collectible', '');
  });
</script>
